@page "/"
@using Microsoft.AspNetCore.Components.Server.ProtectedBrowserStorage
@inject ProtectedLocalStorage ProtectedLocalStorage

<PageTitle>Labs</PageTitle>

<h1>Lab Status</h1>

Please update your status as you work through today's labs.

<table>
  <tr>
    <td>Your name:</td>
    <td><input type="text" @bind-value=@Username /></td>
  </tr>
</table>
<hr />
<p></p>

@if (Username == "admin")
{
  <LabSummary />
}
else if (!string.IsNullOrWhiteSpace(Username))
{
  @ProtectedLocalStorage.SetAsync("username", Username)
  <LabList User=@Username />
}

@code
{
  private string Username { get; set; } = string.Empty;

  protected override async Task OnParametersSetAsync()
  {
    var uname = await ProtectedLocalStorage.GetAsync<string>("username");
    if (uname.Success && !string.IsNullOrWhiteSpace(uname.Value))
      Username = uname.Value;
    await base.OnParametersSetAsync();
  }
}